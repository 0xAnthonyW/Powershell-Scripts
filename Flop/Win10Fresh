#dont run as admin
#work in progress more to add havent ran this yet
#todo maybe work on recycle bin again...
$TaskPass = 'C:\Users\admin\Desktop\PassExpire\TaskPasswordExpire.ps1'
$flipme = 'C:\Users\admin\Desktop\Software\FlipMe.ps1'
$UsbPath = 'D:\PassExpire'
$Destination = 'C:\Users\admin\Desktop'
$PassExpirePath = 'C:\Users\admin\Desktop\PassExpire'
$usrAccount = 'D:\UserAccount.ps1'
$software = 'D:\Software'
$softwareDestination = 'C:\Users\admin\Desktop\Software'
$updates = 'D:\Updates'
$updatesDestination = 'C:\Users\admin\Desktop\Updates'
$Drivers = 'D:\Updates\Scripts\830drivers.bat'
$MSU = 'D:\Updates\Scripts\MSU.ps1'
$WindowsBlocker = 'C:\Users\admin\Desktop\Software\Updated-By-Anthony\WindowsBlocker-V1-2.ps1'

if (Test-Path $softwareDestination) 
{
    Remove-Item -Path $softwareDestination -Force -Recurse
    Copy-Item -Path $software -Recurse -Destination $Destination
    Write-host "Software has been copied to $Destination " -ForegroundColor Green
}
else
{
    Copy-Item -Path $software -Recurse -Destination $Destination
    Write-host "Software has been copied to $Destination " -ForegroundColor Green
}
#Updates Folder
if (Test-Path $updatesDestination) 
{
    Remove-Item -Path $updatesDestination -Force -Recurse
    Copy-Item -Path $updates -Recurse -Destination $Destination
    Write-host "Updates has been copied to $Destination " -ForegroundColor Green
}
else
{
    Copy-Item -Path $updates -Recurse -Destination $Destination
    Write-host "Updates has been copied to $Destination " -ForegroundColor Green
}
#Sets timezone
Set-TimeZone -Name 'Central Standard Time' -PassThru
#UserAccount
Start-Process Powershell "-ExecutionPolicy Bypass -File $usrAccount"
Start-Sleep -Seconds 30
#Drivers
Start-Process Powershell "-ExecutionPolicy Bypass -File $Drivers"
Start-Sleep -Seconds 20
Read-Host "Press enter after drivers finish"
Start-Process Powershell "-ExecutionPolicy Bypass -File $MSU"
Read-Host "Press enter after updates finish"
#Pass Expire
if (Test-Path $PassExpirePath) 
{
    Remove-Item -Path $PassExpirePath -Force -Recurse
    Copy-Item -Path $UsbPath -Recurse -Destination $Destination
    (Get-ChildItem $Destination -Recurse).FullName
}
else
{
    Copy-Item -Path $UsbPath -Recurse -Destination $Destination
    (Get-ChildItem $Destination -Recurse).FullName
}
#TaskPasswordExpire
Start-Process Powershell "-ExecutionPolicy Bypass -File $TaskPass"
Start-Sleep -Seconds 20
#Flip Me
Start-Process Powershell "-ExecutionPolicy Bypass -File $flipme"
Read-Host "Press enter after flip me is done"
Start-Process Powershell "-ExecutionPolicy Bypass -File $WindowsBlocker"
